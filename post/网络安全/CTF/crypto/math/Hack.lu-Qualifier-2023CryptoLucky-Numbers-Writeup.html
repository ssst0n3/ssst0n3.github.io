<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="">
<meta name="description"
    content="tags: ctf,crypto,beginner-friendly
 Hack.lu-Qualifier-2023/Crypto/Lucky Numbers Writeup 1. challenge  Author: zer0 beginner-friendly!  Help me to find my lucky numbers. Bad luck is around&amp;hellip;
nc flu.xxx 10010
Download challenge files
lucky_number.py
#!/usr/bin/env python #hacklu23 Baby Crypyo Challenge import math import random from Crypto.Cipher import AES from Crypto.Random import get_random_bytes import base64 import os def add(e): return e&#43;(length-len(e)%length)*chr(length-len(e)%length) def remove(e): return e[0:-ord(e[-1:])] length=16 def main(): flag= os.environ[&amp;#34;FLAG&amp;#34;] print(&amp;#34;Starting Challenge&amp;#34;) key=get_random_bytes(32) message=add(flag) iv=get_random_bytes(length) cipher=AES." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/post/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/CTF/crypto/math/Hack.lu-Qualifier-2023CryptoLucky-Numbers-Writeup.html" />


<title>
    
    Hack.lu-Qualifier-2023/Crypto/Lucky Numbers Writeup :: welcome to st0n3&#39;s blog 
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.de959d61dd13c2cd41136acd491ffb0749779e1afe37b1fed6d5cba0b7e1938d.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="Hack.lu-Qualifier-2023/Crypto/Lucky Numbers Writeup">
<meta itemprop="description" content="tags: ctf,crypto,beginner-friendly
 Hack.lu-Qualifier-2023/Crypto/Lucky Numbers Writeup 1. challenge  Author: zer0 beginner-friendly!  Help me to find my lucky numbers. Bad luck is around&hellip;
nc flu.xxx 10010
Download challenge files
lucky_number.py
#!/usr/bin/env python #hacklu23 Baby Crypyo Challenge import math import random from Crypto.Cipher import AES from Crypto.Random import get_random_bytes import base64 import os def add(e): return e&#43;(length-len(e)%length)*chr(length-len(e)%length) def remove(e): return e[0:-ord(e[-1:])] length=16 def main(): flag= os.environ[&#34;FLAG&#34;] print(&#34;Starting Challenge&#34;) key=get_random_bytes(32) message=add(flag) iv=get_random_bytes(length) cipher=AES.">
<meta itemprop="datePublished" content="2023-10-17T07:08:08+00:00" />
<meta itemprop="dateModified" content="2023-10-17T07:08:08+00:00" />
<meta itemprop="wordCount" content="658">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hack.lu-Qualifier-2023/Crypto/Lucky Numbers Writeup"/>
<meta name="twitter:description" content="tags: ctf,crypto,beginner-friendly
 Hack.lu-Qualifier-2023/Crypto/Lucky Numbers Writeup 1. challenge  Author: zer0 beginner-friendly!  Help me to find my lucky numbers. Bad luck is around&hellip;
nc flu.xxx 10010
Download challenge files
lucky_number.py
#!/usr/bin/env python #hacklu23 Baby Crypyo Challenge import math import random from Crypto.Cipher import AES from Crypto.Random import get_random_bytes import base64 import os def add(e): return e&#43;(length-len(e)%length)*chr(length-len(e)%length) def remove(e): return e[0:-ord(e[-1:])] length=16 def main(): flag= os.environ[&#34;FLAG&#34;] print(&#34;Starting Challenge&#34;) key=get_random_bytes(32) message=add(flag) iv=get_random_bytes(length) cipher=AES."/>




<meta property="article:published_time" content="2023-10-17 07:08:08 &#43;0000 UTC" />







    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/st0n3</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/aboutme.html">About</a></li><li><a href="/post.html">Blog</a></li><li><a href="/hackerbot">Hackerbot</a></li><li><a href="/skill_tree/">SkillTree</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="/post/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/CTF/crypto/math/Hack.lu-Qualifier-2023CryptoLucky-Numbers-Writeup.html">Hack.lu-Qualifier-2023/Crypto/Lucky Numbers Writeup</a></h2>

            

            <div class="post-content">
                <hr>
<p>tags: ctf,crypto,beginner-friendly</p>
<hr>
<h1 id="hacklu-qualifier-2023cryptolucky-numbers-writeup">Hack.lu-Qualifier-2023/Crypto/Lucky Numbers Writeup</h1>
<h2 id="1-challenge">1. challenge</h2>
<ul>
<li>Author: 	zer0</li>
<li>beginner-friendly!</li>
</ul>
<p>Help me to find my lucky numbers. Bad luck is around&hellip;</p>
<p><code>nc flu.xxx 10010</code></p>
<p><a href="https://challenge.zip/lucky-number_23837cb02981cf2c27e455f46b58b6eb.zip">Download challenge files</a></p>
<p>lucky_number.py</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python</span>
<span style="color:#75715e">#hacklu23 Baby Crypyo Challenge</span>
<span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> random
<span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> AES
<span style="color:#f92672">from</span> Crypto.Random <span style="color:#f92672">import</span> get_random_bytes
<span style="color:#f92672">import</span> base64
<span style="color:#f92672">import</span> os                                                   
    
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(e): <span style="color:#66d9ef">return</span> e<span style="color:#f92672">+</span>(length<span style="color:#f92672">-</span>len(e)<span style="color:#f92672">%</span>length)<span style="color:#f92672">*</span>chr(length<span style="color:#f92672">-</span>len(e)<span style="color:#f92672">%</span>length)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">remove</span>(e): <span style="color:#66d9ef">return</span> e[<span style="color:#ae81ff">0</span>:<span style="color:#f92672">-</span>ord(e[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:])]
length<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span> 

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():  
    flag<span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#34;FLAG&#34;</span>]
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Starting Challenge&#34;</span>)
 
    key<span style="color:#f92672">=</span>get_random_bytes(<span style="color:#ae81ff">32</span>)
    message<span style="color:#f92672">=</span>add(flag)
    iv<span style="color:#f92672">=</span>get_random_bytes(length)
    cipher<span style="color:#f92672">=</span>AES<span style="color:#f92672">.</span>new(key,AES<span style="color:#f92672">.</span>MODE_CBC,iv) 
    cipher_bytes<span style="color:#f92672">=</span>base64<span style="color:#f92672">.</span>b64encode(iv<span style="color:#f92672">+</span>cipher<span style="color:#f92672">.</span>encrypt(message<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#34;utf8&#34;</span>)))
    <span style="color:#66d9ef">print</span>(cipher_bytes<span style="color:#f92672">.</span>decode())

    <span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">5</span>):
        A<span style="color:#f92672">=</span>[]
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;You know the moment when you have this special number that gives you luck? Great cause I forgot mine&#34;</span>)
        data2<span style="color:#f92672">=</span>input()
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;I also had a second lucky number, but for some reason I don&#39;t remember it either :(&#34;</span>)
        data3<span style="color:#f92672">=</span>input()
        v<span style="color:#f92672">=</span>data2<span style="color:#f92672">.</span>strip()
        w<span style="color:#f92672">=</span>data3<span style="color:#f92672">.</span>strip()
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> v<span style="color:#f92672">.</span>isnumeric() <span style="color:#f92672">or</span> <span style="color:#f92672">not</span> w<span style="color:#f92672">.</span>isnumeric():
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;You sure both of these are numbers?&#34;</span>)
            <span style="color:#66d9ef">continue</span>
        s<span style="color:#f92672">=</span>int(data2)
        t<span style="color:#f92672">=</span>int(data3)
        <span style="color:#66d9ef">if</span> s<span style="color:#f92672">&lt;</span>random<span style="color:#f92672">.</span>randrange(<span style="color:#ae81ff">10000</span>,<span style="color:#ae81ff">20000</span>):
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;I have the feeling the first number might be too small&#34;</span>)
            <span style="color:#66d9ef">continue</span>
        <span style="color:#66d9ef">if</span> s<span style="color:#f92672">&gt;</span>random<span style="color:#f92672">.</span>randrange(<span style="color:#ae81ff">150000000000</span>,<span style="color:#ae81ff">200000000000</span>):
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;I have the feeling the first number might be too big&#34;</span>)
            <span style="color:#66d9ef">continue</span>
        <span style="color:#66d9ef">if</span> t<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">42</span>:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;I have the feeling the second number might be too big&#34;</span>)
            <span style="color:#66d9ef">continue</span>

        n<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>t<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
        sent<span style="color:#f92672">=</span>False
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>,int(n<span style="color:#f92672">**</span><span style="color:#ae81ff">0.5</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
             <span style="color:#66d9ef">if</span> (n<span style="color:#f92672">%</span>i) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
                <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;The second number didn&#39;t bring me any luck...&#34;</span>)
                sent <span style="color:#f92672">=</span> True
                <span style="color:#66d9ef">break</span>
        <span style="color:#66d9ef">if</span> sent:
            <span style="color:#66d9ef">continue</span>
        u<span style="color:#f92672">=</span>t<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
        number<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>u)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>(t)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
        sqrt_num<span style="color:#f92672">=</span>math<span style="color:#f92672">.</span>isqrt(s)
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,sqrt_num<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
            <span style="color:#66d9ef">if</span> s<span style="color:#f92672">%</span>i<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>:
                A<span style="color:#f92672">.</span>append(i)
                <span style="color:#66d9ef">if</span> i<span style="color:#f92672">!=</span>s<span style="color:#f92672">//</span>i <span style="color:#f92672">and</span> s<span style="color:#f92672">//</span>i<span style="color:#f92672">!=</span>s:
                    A<span style="color:#f92672">.</span>append(s<span style="color:#f92672">//</span>i)      
        total<span style="color:#f92672">=</span>sum(A)
        <span style="color:#66d9ef">if</span> total<span style="color:#f92672">==</span>s<span style="color:#f92672">==</span>number:
            decoded<span style="color:#f92672">=</span>base64<span style="color:#f92672">.</span>b64decode(cipher_bytes)
            cipher<span style="color:#f92672">=</span>AES<span style="color:#f92672">.</span>new(key,AES<span style="color:#f92672">.</span>MODE_CBC,iv)
            decoded_bytes<span style="color:#f92672">=</span>remove(cipher<span style="color:#f92672">.</span>decrypt(decoded[length:]))
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;You found them, well done! Here have something for your efforts: &#34;</span>)
            <span style="color:#66d9ef">print</span>(decoded_bytes<span style="color:#f92672">.</span>decode())
            exit()
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Hm sadge, those don&#39;t seem to be my lucky numbers...😞&#34;</span>)
    
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Math is such a cool concept, let&#39;s see if you can use it a little more...&#34;</span>)
    exit()
  
<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    main()
</code></pre></div><h2 id="2-分析">2. 分析</h2>
<p>一个简单数学问题，也可以忽略数学关系，直接爆破。总之是一个新手友好题。</p>
<p>10000 &lt;= s &lt;= 200000000000, 0 &lt;= t &lt;= 42</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> v<span style="color:#f92672">.</span>isnumeric() <span style="color:#f92672">or</span> <span style="color:#f92672">not</span> w<span style="color:#f92672">.</span>isnumeric():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;You sure both of these are numbers?&#34;</span>)
    <span style="color:#66d9ef">continue</span>
s<span style="color:#f92672">=</span>int(data2)
t<span style="color:#f92672">=</span>int(data3)
<span style="color:#66d9ef">if</span> s<span style="color:#f92672">&lt;</span>random<span style="color:#f92672">.</span>randrange(<span style="color:#ae81ff">10000</span>,<span style="color:#ae81ff">20000</span>):
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;I have the feeling the first number might be too small&#34;</span>)
    <span style="color:#66d9ef">continue</span>
<span style="color:#66d9ef">if</span> s<span style="color:#f92672">&gt;</span>random<span style="color:#f92672">.</span>randrange(<span style="color:#ae81ff">150000000000</span>,<span style="color:#ae81ff">200000000000</span>):
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;I have the feeling the first number might be too big&#34;</span>)
    <span style="color:#66d9ef">continue</span>
<span style="color:#66d9ef">if</span> t<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">42</span>:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;I have the feeling the second number might be too big&#34;</span>)
    <span style="color:#66d9ef">continue</span>
</code></pre></div><p>n 素数</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">n<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>t<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
sent<span style="color:#f92672">=</span>False
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>,int(n<span style="color:#f92672">**</span><span style="color:#ae81ff">0.5</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
     <span style="color:#66d9ef">if</span> (n<span style="color:#f92672">%</span>i) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;The second number didn&#39;t bring me any luck...&#34;</span>)
        sent <span style="color:#f92672">=</span> True
        <span style="color:#66d9ef">break</span>
<span style="color:#66d9ef">if</span> sent:
    <span style="color:#66d9ef">continue</span>
</code></pre></div><p>$s = 2^{t-1}*(2^t-1)$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">u<span style="color:#f92672">=</span>t<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
number<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>u)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>(t)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
sqrt_num<span style="color:#f92672">=</span>math<span style="color:#f92672">.</span>isqrt(s)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,sqrt_num<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
    <span style="color:#66d9ef">if</span> s<span style="color:#f92672">%</span>i<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>:
        A<span style="color:#f92672">.</span>append(i)
        <span style="color:#66d9ef">if</span> i<span style="color:#f92672">!=</span>s<span style="color:#f92672">//</span>i <span style="color:#f92672">and</span> s<span style="color:#f92672">//</span>i<span style="color:#f92672">!=</span>s:
            A<span style="color:#f92672">.</span>append(s<span style="color:#f92672">//</span>i)      
total<span style="color:#f92672">=</span>sum(A)
<span style="color:#66d9ef">if</span> total<span style="color:#f92672">==</span>s<span style="color:#f92672">==</span>number:
    <span style="color:#75715e"># print flag</span>
</code></pre></div><p>根据 $s = 2^{t-1}*(2^t-1)$ 直接生成 t 所对应的 s 即可，总计至多 42 个组合，不必处理 A 的生成。</p>
<p>实际上, s=sum(A) 是直接成立的。</p>
<p>$$
\begin{align*}
s &amp;= sum(A) \newline
&amp;= 2^0 + (2^1 + 2^{t-2}*(2^t-1)) + &hellip; + (2^i + 2^{t-i-1}*(2^t-1)) + &hellip; + (2^{t-1} + 2^0*(2^t-1)) \newline
&amp;= (2^0 + 2^1 + &hellip; + 2^i + &hellip; + 2^{t-1}) + 2^0*(2^t-1) + &hellip; + 2^{t-2}*(2^t-1) \newline
&amp;= 2^t - 1 + (2^{t-1}-1)*(2^t-1) \newline
&amp;= 2^{t-1}*(2^t-1)
\end{align*}
$$</p>
<h2 id="3-solve">3. solve</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> isPrime

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">solve</span>():
    answer <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> t <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">42</span>):
        n <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>t<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">if</span> isPrime(n):
            u <span style="color:#f92672">=</span> t<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
            s <span style="color:#f92672">=</span> (<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>u)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>(t)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
            <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">10000</span> <span style="color:#f92672">&lt;=</span> s <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">200000000000</span>:
                answer<span style="color:#f92672">.</span>append((s, t))
    <span style="color:#66d9ef">return</span> answer

answer <span style="color:#f92672">=</span> solve(); answer
</code></pre></div><pre><code>[(33550336, 13), (8589869056, 17), (137438691328, 19)]
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

r <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;flu.xxx&#34;</span>, <span style="color:#ae81ff">10010</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">io</span>(s, t):
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Great cause I forgot mine&#34;</span>, str(s)<span style="color:#f92672">.</span>encode())
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;I don&#39;t remember it either :(&#34;</span>, str(t)<span style="color:#f92672">.</span>encode())
    r<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;for your efforts: </span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
    flag <span style="color:#f92672">=</span> r<span style="color:#f92672">.</span>recv()
    <span style="color:#66d9ef">print</span>(flag)

io(<span style="color:#f92672">*</span>answer[<span style="color:#ae81ff">0</span>])
r<span style="color:#f92672">.</span>close()
</code></pre></div><pre><code>[x] Opening connection to b'flu.xxx' on port 10010
[x] Opening connection to b'flu.xxx' on port 10010: Trying 31.22.123.45
[+] Opening connection to b'flu.xxx' on port 10010: Done
b'flag{luck_0n_fr1d4y_th3_13th?}\n'
[*] Closed connection to b'flu.xxx' port 10010
</code></pre>
<h2 id="4-something-interesting">4. Something interesting</h2>
<p>官方服务器似乎少了一行代码：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> s<span style="color:#f92672">&lt;</span>random<span style="color:#f92672">.</span>randrange(<span style="color:#ae81ff">10000</span>,<span style="color:#ae81ff">20000</span>):
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;I have the feeling the first number might be too small&#34;</span>)
    <span style="color:#66d9ef">continue</span>
</code></pre></div><p>导致有一些非预期解</p>
<pre><code>❯ nc flu.xxx 10010

Starting Challenge
S8mQF5KqwDOu1PioMqy+ogh7o6V4YFEwy3ZNOLFFyBRPV4A8nsBoKbM1K8/1cnLu
You know the moment when you have this special number that gives you luck? Great cause I forgot mine
1
I also had a second lucky number, but for some reason I don't remember it either :(
1
You found them, well done! Here have something for your efforts: 
flag{luck_0n_fr1d4y_th3_13th?}
</code></pre><hr>
<p>本文同步发表于</p>
<ul>
<li>blog: ssst0n3.github.io</li>
<li>公众号: 石头的安全料理屋</li>
<li>知乎专栏: 石头的安全料理屋</li>
</ul>

            </div>
        </article>

        <hr />

        <div class="post-info">
  			</div>

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            
            <span></span>
            <span> <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/st0n3">st0n3</a></span>
            <span>Based on <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>

    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      extensions: ["tex2jax.js"],
      
      jax: ["input/TeX", "output/CommonHTML"],
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
      },
      "HTML-CSS": { fonts: ["TeX"] },
      displayAlign: "left"
    });
  </script>

<script async src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_CHTML"></script>


</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.4c3fb12a087ceed4a52cb5d57068a9795c7069617a01ca70f788052ad66e1791779e6c72686e1dc0ca13dc03b0203204b6566bb0dd1ee80de2b7ff4d8fe53db2.js" integrity="sha512-TD&#43;xKgh87tSlLLXVcGipeVxwaWF6Acpw94gFKtZuF5F3nmxyaG4dwMoT3AOwIDIEtlZrsN0e6A3it/9Nj&#43;U9sg=="></script>



    </body>
</html>
